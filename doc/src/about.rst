.. raw:: html

   <!--

   ============================================================================

      DO NOT EDIT THIS FILE! It was generated using Sphinx from:

      Origin:   $URL$
      Revision: $Rev$

   ============================================================================

   -->

.. title:: About GLISTR Algorithm

.. meta::
   :description: Brief overview of GLISTR algorithm.
   :keywords: GLISTR Algorithm.


.. raw:: html

    <br />
   
====================
About the algorithm
====================

.. raw:: html

    <br />

    
Computerized analysis of glioma images can be clinically important for different reasons. Segmentation of multi-channel MR glioma images into different tissue classes might be insightful for neuro-surgical interventions as surgeons aim to resect the most of tumor while minimizing the risk of damaging the healthy surrounding tissues. However, manual tracing of tumor borders can be a very tedious task and might be inaccurate due to the errors introduced in border delineation process. Therefore, a reliable automatic segmentation algorithm can be helpful to provide labelings of the patient tissues and facilitate the subsequent expert editing.

On the other hand, deformable registration of brain tumor images allows us to map data from different brain tumor patients into a common stereotaxic space, thereby enabling us the construction of statistical brain tumor atlases. These atlases are based on collective morphological, functional, and pathological information and increase our understanding of the Glioma's specific behavior in various regions of the brain. For example, Glioma atlases are used for tasks such as learning the relative location of tumors with respect to the tumor grades.

.. We solve this problem by the **GLISTR**, firstly introduced in [TMI2012]_ and later conceptually improved in [MICCAI2014]_. [MICCAI2011]_ is a previous version of [TMI2012]_ and it builds upon the prior work integrating deformable registration and tumor growth modeling [TMI2011]_, and using the classic expectation maximization (EM) algorithm for tumor model parameter estimation. GLISTR is a method for simultaneously segmenting brain scans of glioma patients and registering these scans to a normal atlas. Performing joint segmentation and registration for brain tumors is very challenging when tumors include multifocal masses and have complex shapes with heterogeneous textures. GLISTR grows tumors for each mass from multiple seed points using a tumor growth model [JMB2008]_ and modifies a normal atlas into one with tumors and edema using the combined results of grown tumors. GLISTR also generates a tumor shape prior via the random walk with restart, utilizing multiple tumor seeds as initial foreground information. GLISTR then incorporate this shape prior into an EM framework which estimates the mapping between the modified atlas and the scans, posteriors for each tissue labels, and the tumor growth model parameters.

.. _`Figure 1`:

.. only:: html

    .. figure::    Mglistr_examples.jpg
        :alt:      GLISTR examples.
        :align:    center
        :width:    550px
        :figwidth: 100%
		
        Figure 1: An example of spatial probabilities for multifocal glioma. We show subject scans in (a)-(b), normal atlas in (h)-(i), spatial probabilities obtained by growing tumors on normal atlas in (c)-(f), tumor shape prior in (g), spatial probabilities aligned to the scan in (j)-(m), and tumor posterior in (n).

.. only:: latex

    .. figure::    Mglistr_examples.jpg
        :alt:      GLISTR examples.
        :align:    center
        :width:    75%
        :figwidth: 100%

        An example of spatial probabilities for multifocal glioma. We show subject scans in (a)-(b), normal atlas in (h)-(i), spatial probabilities obtained by growing tumors on normal atlas in (c)-(f), tumor shape prior in (g), spatial probabilities aligned to the scan in (j)-(m), and tumor posterior in (n).
   
In `Figure 1`_, an example of spatial probabilities for multifocal glioma obtained by GLISTR is shown. The spatial probabilities in (c)-(f) are modified from the atlas shown in (h)-(i) using the tumor growth model. The tumor shape prior is shown in (g) computer obtained applying the random walk with restart on the subject scan shown in (a)-(b). This shape prior shows high probability values in the tumor region. Aligned spatial probabilities are shown in (j)-(m) optimized via the EM algorithm. These spatial probabilities and the tumor posterior shown in (n) fit well to healthy tissue and pathological regions shown in (a)-(b).

GLISTR requires minimal user initializations including seed points and radius for each tumor and one sample point for each tissue class. Users could use the visual interface called BrainTumorViewer_ to easily mark each point. Another input to GLISTR consists of the preprocessed patient scans and a list of probabilistic atlas priors representing a healthy population (we use jakob or eve currently). For preprocessing, we coregistered all modalities, corrected MR field inhomogeneity, skull stripping, and scaled intensities to fit [0, 255]. The output of GLISTR consists of a label map corresponding to the patient scans, deformation field(s) warping the originally normal atlas into the patient space, and the estimated tumor model parameters.

The current implementation of GLISTR accepts four MR modalities: T1, T1-CE, T2, and FLAIR. It segments these images into 10 labels: cerebrospinal fluid (CSF), gray matter (GM), white matter (WM), vessel (VS), edema (ED), necrosis (NCR), enhancing tumor (TU), non-enhancing tumor (NE) (optional), cerebellum (CB), and background (BG). We also define NT as the union of NE and NCR.

.. _`Figure 2`:

.. only:: html
    
    .. figure::    Mglistr_results.jpg
        :alt:      GLISTR results.
        :align:    center
        :width:    550px
        :figwidth: 100%
      
        Figure 2: Segmentation and registration results for 3 subjects selected from the BRATS 2013 leaderboard data set. The top 1 row shows a single-focal glioma and bottom 2 rows show multi-focal gliomas. We show subject images in (a)-(b), segmentation results in (c) (indicating ET, NT, ED, WM, GM, and CSF in blue, red, cyan, white, gray, and yellow colors, respectively), spatial probabilities in (d)-(g), and tumor shape priors in (h).

.. only:: latex
    
    .. figure::    Mglistr_results.jpg
        :alt:      GLISTR results.
        :align:    center
        :width:    75%
        :figwidth: 100%
       
        Segmentation and registration results for 3 subjects selected from the BRATS 2013 leaderboard data set. The top 1 row shows a single-focal glioma and bottom 2 rows show multi-focal gliomas. We show subject images in (a)-(b), segmentation results in (c) (indicating ET, NT, ED, WM, GM, and CSF in blue, red, cyan, white, gray, and yellow colors, respectively), spatial probabilities in (d)-(g), and tumor shape priors in (h).

In `Figure 2`_, segmentation and registration results of GLISTR selected from the BRATS 2013 leaderboard data set are displayed. The top 1 row shows a single-focal glioma and bottom 2 rows show multi-focal gliomas. The subject images are shown in (a)-(b) and segmentation results are shown in (c) (indicating ET, NT, ED, WM, GM, and CSF in blue, red, cyan, white, gray, and yellow colors, respectively). The spatial probabilities aligned to the scan in (d)-(g) show that they fit well to the scan. The tumor shape priors in (h) help to align spatial probabilities for tumor as they initially estimate tumor regions reasonably well. However, GLISTR also showed robust estimation of tumor regions when the shape prior leaked into nearby regions as indicated by arrow in the fourth row of (h). The spatial probabilities for tumor were not expanded to this leaked region as the image likelihood for tumor kept lower values than those of healthy tissues on this region during the EM iterations. As a result, segmentations in (c) show visually reasonable tissue estimation especially for ET, NT, and ED regions.


.. raw:: html

    <br />


.. _BrainTumorViewer: http://www.cbica.upenn.edu/sbia/software/braintumorviewer/
